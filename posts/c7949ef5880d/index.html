<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>【BUUCTF】MISC(第3页wp) | Tranquility</title><meta name="keywords" content="【BUUCTF】MISC(第3页wp)"><meta name="author" content="LIKE"><meta name="copyright" content="LIKE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[TOC] [SUCTF2018]single dog我们使用foremost分离jpg图片     打开txt文件：  发现是js颜文字加密（AAEncode） ，使用   AAEncode解密  我吃三明治我们在图片中发现了一串类似base32加密的串：  使用base32网站解密  sqltest我们使用 wireshark 打开 pcapng 文件，然后导出http对象：   我们发现有很">
<meta property="og:type" content="article">
<meta property="og:title" content="【BUUCTF】MISC(第3页wp)">
<meta property="og:url" content="https://leekoscn.github.io/posts/c7949ef5880d/index.html">
<meta property="og:site_name" content="Tranquility">
<meta property="og:description" content="[TOC] [SUCTF2018]single dog我们使用foremost分离jpg图片     打开txt文件：  发现是js颜文字加密（AAEncode） ，使用   AAEncode解密  我吃三明治我们在图片中发现了一串类似base32加密的串：  使用base32网站解密  sqltest我们使用 wireshark 打开 pcapng 文件，然后导出http对象：   我们发现有很">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://leekoscn.github.io/img/hello-world.webp">
<meta property="article:published_time" content="2023-08-22T10:05:22.340Z">
<meta property="article:modified_time" content="2023-06-05T06:42:12.275Z">
<meta property="article:author" content="LIKE">
<meta property="article:tag" content="【BUUCTF】MISC(第3页wp)">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leekoscn.github.io/img/hello-world.webp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://leekoscn.github.io/posts/c7949ef5880d/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: LIKE","link":"链接: ","source":"来源: Tranquility","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【BUUCTF】MISC(第3页wp)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-05 14:42:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/cursor.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-clock/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">215</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/hello-world.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Tranquility</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【BUUCTF】MISC(第3页wp)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-22T10:05:22.340Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-05T06:42:12.275Z" title="更新于 2023-06-05 14:42:12">2023-06-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【BUUCTF】MISC(第3页wp)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>[TOC]</p>
<h2 id="SUCTF2018-single-dog"><a href="#SUCTF2018-single-dog" class="headerlink" title="[SUCTF2018]single dog"></a>[SUCTF2018]single dog</h2><p>我们使用<code>foremost</code>分离jpg图片</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/4pye7Ha9sRUoP3L.png" alt="image-20230129103003958" style="zoom:33%;" />



<p>打开txt文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/iJjDoBt7nhcO4Xk.png" alt="image-20230129103110636"></p>
<p>发现是js颜文字加密（<code>AAEncode</code>） ，使用   <a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=703">AAEncode解密</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/1bsAPcFRYyUWJBu.png" alt="image-20230129104030772"></p>
<h2 id="我吃三明治"><a href="#我吃三明治" class="headerlink" title="我吃三明治"></a>我吃三明治</h2><p>我们在图片中发现了一串类似base32加密的串：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/yxczdZtf3l6GvkD.png" alt="image-20230129104715887"></p>
<p>使用base32网站解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/HpNRE237dyMKjoY.png" alt="image-20230129104540410"></p>
<h2 id="sqltest"><a href="#sqltest" class="headerlink" title="sqltest"></a>sqltest</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>我们使用 <code>wireshark</code> 打开 <code>pcapng</code> 文件，然后导出http对象：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/W4Kr3c6sYpgvbGM.png" alt="image-20230129105328438" style="zoom:33%;" />

<p>我们发现有很多 sql注入的测试，我们可以通过这些sql注入来判断flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/CSUWw6JXykMqrDb.png" alt="image-20230129105400454"></p>
<p>我们一个一个判断，得出flag的ascii值：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/gYeHybsL3ujhQVW.png" alt="image-20230129105926330"></p>
<p><code>102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50  56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125</code></p>
<p>我们将其转化为字符：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/Oo8LIjX6UsuCQEG.png" alt="image-20230129110200781"></p>
<h2 id="SWPU2019-你有没有好好看网课"><a href="#SWPU2019-你有没有好好看网课" class="headerlink" title="[SWPU2019]你有没有好好看网课?"></a>[SWPU2019]你有没有好好看网课?</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/Bv3cCr2JMqOyziZ.png" alt="image-20230129110358654"></p>
<p>我们使用 <code>ARCHPR</code> 爆破密码：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/ITQdGHvURAbfjCs.png" alt="image-20230129110446883" style="zoom:33%;" />

<p>打开文件夹：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/J2Ly9PKbxE36slC.png" alt="image-20230129111232307" style="zoom:33%;" />

<p>我们打开 word文档：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/ayYFBrxgfs1tpZO.png" alt="image-20230129111309981" style="zoom: 33%;" />

<p><code>5.20 7.11</code>这个猜测是视频的秒数，我们使用 <code>Kinovea</code> 打开视频（可以一帧一帧的看视频）：</p>
<p>在 5.66秒处发现提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/EXapkQ3VoixnJLO.png" alt="在这里插入图片描述"></p>
<p><strong>敲击码</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">..... ../... ./... ./... ../</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/fLzHXeiIu91UkJc.png" alt="image-20230129111924224"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">..... ../... ./... ./... ../	通过斜杠分为不同的组</span><br><span class="line"> 5  2 / 3 1 / 3 1/ 3 2/</span><br><span class="line">  W      L    L    M</span><br></pre></td></tr></table></figure>

<p>在 7.36 秒 发现第二段信息：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/EVfvZzF74TKWDIj.png" alt="在这里插入图片描述"></p>
<p>base64解密，我们可以使用 <code>php -r</code> 在命令行执行php代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/hswVknj4FlmUaC7.png" alt="image-20230129112446845"></p>
<p>两段密码拼接一下得到 flag1 压缩包密码。</p>
<p><code>010Editor</code> 打开图片得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/whK9lVmRtvgyqFQ.png" alt="image-20230129112653089"></p>
<h2 id="ACTF新生赛2020-NTFS数据流"><a href="#ACTF新生赛2020-NTFS数据流" class="headerlink" title="[ACTF新生赛2020]NTFS数据流"></a>[ACTF新生赛2020]NTFS数据流</h2><blockquote>
<p>NTFS交换数据流（alternate data streams，简称<strong>ADS</strong>）是NTFS磁盘格式的一个特性，在NTFS文件系统下，每个文件都可以存在多个数据流，就是说除了主文件流之外还可以有许多非主文件流寄宿在主文件流中。它使用资源派生来维持与文件相关的信息，虽然我们无法看到数据流文件，但是它却是真实存在于我们的系统中的。创建一个数据交换流文件的方法很简单，命令为“宿主文件：准备与宿主文件关联的数据流文件”。————百度百科</p>
</blockquote>
<p>我们打开文件夹，发现一个大小不一样的文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/XurikSsWEwb4nt3.png" alt="image-20230129113028979"></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/SOIJpt5xB6NGEDe.png" alt="image-20230129113049930" style="zoom:33%;" />

<p><strong>注意：这里解压的时候使用Win RAR解压，涉及NTFS流的都需要Win RAR解压</strong></p>
<p>然后我们使用工具 ：<code>NtfsStreamsEditor</code>  扫描txt文件：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/AyO5EtucQeYvRmj.png" alt="image-20230129114158966" style="zoom: 33%;" />

<p>发现 293.txt 文件中 还存在一个flag.txt 文件，直接打开获得flag。</p>
<p>或者，使用命令 <code>notepad</code> 打开：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/mLVM8NTHy9oGK1a.png" alt="image-20230129114339368" style="zoom:33%;" />



<h2 id="john-in-the-middle"><a href="#john-in-the-middle" class="headerlink" title="john-in-the-middle"></a>john-in-the-middle</h2><p>使用 wireshark 带出http对象：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/YZqwnRGkVS6Qr8b.png" alt="image-20230129115118464"></p>
<p>使用 stegsolve分析，得到flag</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/rGksuZiIpUQEAol.png" alt="image-20230129115054515" style="zoom:50%;" />





<h2 id="ACTF新生赛2020-swp"><a href="#ACTF新生赛2020-swp" class="headerlink" title="[ACTF新生赛2020]swp"></a>[ACTF新生赛2020]swp</h2><p>我们导出 http 对象，发现一个 <code>secret.zip</code> 压缩包</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/9nomXfUzig6HxA8.png" alt="image-20230129122549451" style="zoom:33%;" />

<p>然后发现是 zip 伪加密，我们可以使用工具：<code>ZipCenOp</code> 修复：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/jYLKMo6P91bEBdn.png" alt="image-20230129122731337"></p>
<p>搜索 <code>ctf</code> 发现 flag：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/xDzOYmRZadl8cXI.png" alt="image-20230129122827157" style="zoom:33%;" />



<h2 id="喵喵喵"><a href="#喵喵喵" class="headerlink" title="喵喵喵"></a>喵喵喵</h2><p>首先我们使用 <code>Stegsolve</code> 打开：</p>
<p>发现图片 <code>Blue 0通道</code> 有问题</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/ph5EcqVtMl1OdGZ.png" alt="image-20230129132510580" style="zoom:33%;" />



<p>我们使用 <code>Data Extract</code> ，<strong>LSB隐写</strong>，我们使用 <code>BGR</code> 的<code>位平面顺序:</code></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/MDyLHjtuaVPsObi.png" alt="image-20230129132711620" style="zoom:33%;" />

<p>保存为 png 图片，一张不全的二维码，我们改一下高度：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/mZ3aqPFosLKg2UE.png" alt="image-20230129132854243" style="zoom:33%;" />

<p>扫码获得一个链接，下载得到一个txt文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/RmEQuUtcDFOyCqs.png" alt="image-20230129133014277"></p>
<p>说flag不在这里，但是肯定在这里，只是我们看不到而已看，我们想到了 <strong>NTFS数据流隐写</strong> ，我们使用工具：<code>NtfsStreamsEditor2</code> </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/KfLDg5Sdvh9U2EX.png" alt="image-20230129133239370"></p>
<p>发现隐藏了一个 flag.pyc 文件，我们导出该文件。</p>
<blockquote>
<p><strong>pyc文件</strong>就是由Python文件经过编译后所生成的文件，py文件编译成pyc文件后加载速度更快而且提高了代码的安全性。</p>
</blockquote>
<p>我们知道 pyc 文件是 python经过编译后的文件，我们可以使用  <a target="_blank" rel="noopener" href="https://tool.lu/pyc/">反编译</a></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/veOU8t2zPIbGM9m.png" alt="image-20230129133514859" style="zoom:33%;" />

<p>获得 py文件，我们只需要将代码反过来，自己写一个解码函数，将其解码即可：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    ciphertext = ciphertext[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        ciphertext[i] = <span class="built_in">int</span>(ciphertext[i])</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            ciphertext[i] = <span class="built_in">chr</span>(ciphertext[i] - <span class="number">10</span>) </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext[i] = <span class="built_in">chr</span>(ciphertext[i] + <span class="number">10</span>) </span><br><span class="line"></span><br><span class="line">        s = <span class="built_in">chr</span>(<span class="built_in">ord</span>(ciphertext[i]) ^ i)</span><br><span class="line">        <span class="built_in">print</span>(s,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/tVPqH7x49Wvnz1N.png" alt="image-20230129134333993"></p>
<h2 id="GXYCTF2019-SXMgdGhpcyBiYXNlPw"><a href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw" class="headerlink" title="[GXYCTF2019]SXMgdGhpcyBiYXNlPw=="></a>[GXYCTF2019]SXMgdGhpcyBiYXNlPw==</h2><p>打开txt文件，发现很多base64编码</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/WD8iXESyUIm6lhb.png" alt="image-20230129134446387" style="zoom:33%;" />

<p>我们怀疑这可能是<strong>base64隐写</strong>，我们使用脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    base64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_stego</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C://Users/LIKE/Desktop/base64.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).decode(<span class="string">&#x27;base64&#x27;</span>).encode(<span class="string">&#x27;base64&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="built_in">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += <span class="built_in">bin</span>(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">goflag</span>(<span class="params">bin_str</span>):</span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += <span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>

<p>解密得到flag：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/kqTV67FbeWlapyN.png" alt="image-20230129134948748"></p>
<h2 id="间谍启示录"><a href="#间谍启示录" class="headerlink" title="间谍启示录"></a>间谍启示录</h2><blockquote>
<p>在城际公路的小道上，罪犯G正在被警方追赶。警官X眼看他正要逃脱，于是不得已开枪击中了罪犯G。罪犯G情急之下将一个物体抛到了前方湍急的河流中，便头一歪突然倒地。警官X接近一看，目标服毒身亡。数分钟后，警方找到了罪犯遗失物体，是一个U盘，可惜警方只来得及复制镜像，U盘便报废了。警方现在拜托你在这个镜像中找到罪犯似乎想隐藏的秘密。 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载得到一个 <strong>iso</strong> 文件，我们使用foremost分离，发现一个压缩包：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/ECi13l6GyFp2nDI.png" alt="image-20230129135458553"></p>
<p>双击运行<code>flag.exe</code>，获得一个txt文件，得到flag：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/cWYaSI5dbtqs6fC.png" alt="image-20230129135553032"></p>
<h2 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020]docx"></a>[UTCTF2020]docx</h2><p>下载后获得一个 word文档，我们将其后缀改为 <code>zip</code> 解压：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/dk9hErL6b2Pc3vm.png" alt="image-20230129140058666" style="zoom:33%;" />

<p>然后我们在： <code>word/media</code> 文件夹中发现flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/PRSxa3VlINj1tnE.png" alt="image-20230129140120297"></p>
<h2 id="Mysterious"><a href="#Mysterious" class="headerlink" title="Mysterious"></a>Mysterious</h2><blockquote>
<p>自从报名了CTF竞赛后，小明就辗转于各大论坛，但是对于逆向题目仍是一知半解。有一天，一个论坛老鸟给小明发了一个神秘的盒子，里面有开启逆向思维的秘密。小明如获至宝，三天三夜，终于解答出来了，聪明的你能搞定这个神秘盒子么？ 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载后获得一个 <code>exe</code> 文件：</p>
<p>使用记事本打开：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/QHZROMB7Pyt3NaF.png" alt="image-20230129141140114" style="zoom:33%;" />

<p><code>PE...L...</code> 说明是32位。</p>
<p>或者linux使用<strong>file命令</strong>：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/RbBhVvl9drJ7xCi.png" alt="image-20230129141401253"></p>
<p>此处是32位，所以我们使用逆向工具 :<code>ida</code>打开</p>
<p><code>Shift+F12</code> 查看字符串：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/dYCVXvzfi7s5NLj.png" alt="image-20230129141544996"></p>
<p>发现 <code>well_done</code> 可疑，我们点进去：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/Cqe5nVZGN8hxoyW.png" alt="image-20230129141654568"></p>
<p>疑似flag的字符串，我们找到这个地址 <code>sub_401090</code> ，点击后，<strong>按 F5 进行反汇编</strong>：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/TJSYmItdsByf8l5.png" alt="image-20230129141834441"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ( a3 == 1000 )</span><br><span class="line">    &#123;</span><br><span class="line">      GetDlgItemTextA(hWnd, 1002, String, 260);</span><br><span class="line">      strlen(String);</span><br><span class="line">      if ( strlen(String) &gt; 6 )</span><br><span class="line">        ExitProcess(0);</span><br><span class="line">      v4 = atoi(String);</span><br><span class="line">      Value = v4 + 1;</span><br><span class="line">      if ( v4 == 122 &amp;&amp; String[3] == 120 &amp;&amp; String[5] == 122 &amp;&amp; String[4] == 121 )</span><br><span class="line">      &#123;</span><br><span class="line">        strcpy(Text, &quot;flag&quot;);</span><br><span class="line">        memset(&amp;Text[5], 0, 0xFCu);</span><br><span class="line">        v8 = 0;</span><br><span class="line">        v9 = 0;</span><br><span class="line">        _itoa(Value, Source, 10);</span><br><span class="line">        strcat(Text, &quot;&#123;&quot;);</span><br><span class="line">        strcat(Text, Source);</span><br><span class="line">        strcat(Text, &quot;_&quot;);</span><br><span class="line">        strcat(Text, &quot;Buff3r_0v3rf|0w&quot;);</span><br><span class="line">        strcat(Text, &quot;&#125;&quot;);</span><br><span class="line">        MessageBoxA(0, Text, &quot;well done&quot;, 0);</span><br><span class="line">      &#125;</span><br><span class="line">      SetTimer(hWnd, 1u, 0x3E8u, TimerFunc);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/YUlmigLazKbqN4G.png" alt="在这里插入图片描述"></p>
<p>根据分析 我们输入 <code>122xyz</code> 可以获得flag：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/mdtQfyVkawM3NG6.png" alt="image-20230129142112395" style="zoom:33%;" />



<h2 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h2><blockquote>
<p>老菜鸡，伤了神，别灰心，莫放弃，试试弱口令 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载后得到zip压缩包，在注释中藏有信息。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/QAj4ge3MqwnlI9p.png" alt="image-20230129161114294" style="zoom:33%;" />

<p>我们把它复制到 <code>sublime</code> 中：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/6FAbfD7LNPJXKud.png" alt="image-20230129161219999" style="zoom: 50%;" />

<p>这时莫斯电码，我们把空格看成 <strong>.</strong> tab键看成 <strong>-</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.... . .-.. .-.. ----- ..-. --- .-. ..- --</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.all-tool.cn/Tools/morse/">摩斯电码解密</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/17mIZoxvWGEO2Qn.png" alt="image-20230129161539201"></p>
<p>使用该密码将压缩包进行解密，得到一张图片：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/EhnF9THOq3RfeBC.png" alt="image-20230129161707353"></p>
<p>然后这里的考点是 <strong>弱口令LSB隐写</strong>，我们使用工具 ： <code>cloacked-pixel</code></p>
<p><code>这个工具要安装好多模块，容易报错..</code></p>
<p>由于是弱口令，我们猜测密码为 <code>123456</code></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/2uks9onH8gTiJIy.png" alt="image-20230129162240130" style="zoom:50%;" />

<p><code>flag.txt</code>文件包含flag</p>
<h2 id="RoarCTF2019-黄金6年"><a href="#RoarCTF2019-黄金6年" class="headerlink" title="[RoarCTF2019]黄金6年"></a>[RoarCTF2019]黄金6年</h2><p>下载mp4文件，我们使用 <code>Kinovea</code> 打开：</p>
<p>发现有几个二维码</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/tCKrGhYQUBWFfHm.png" alt="image-20230129164331996" style="zoom:33%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/IHPCgNmsy7ZbKl3.png" alt="image-20230129164508418" style="zoom:33%;" />



<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/Z3BxFwYmvQpdGhN.png" alt="image-20230129164608100" style="zoom:33%;" />



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/Mfpqst4L1WnQNjC.png" alt="image-20230129165105841"></p>
<p><code>Kinovea</code>没有key4，我们可以使用<code>potplayer</code> : F键前进一帧，D键倒退一帧，空格键正常播放</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key: iwantplayctf</span><br></pre></td></tr></table></figure>

<p><code>010Editor</code> 打开MP4：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/GeoaAEmsLZk27VY.png" alt="image-20230129165305523" style="zoom:33%;" />

<p> <a target="_blank" rel="noopener" href="https://the-x.cn/base64">base64解码</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/L9pnyPCzxwcuifb.png" alt="image-20230129165437932"></p>
<p>另存为 rar，使用key解压，得到flag</p>
<h2 id="小易的U盘"><a href="#小易的U盘" class="headerlink" title="小易的U盘"></a>小易的U盘</h2><blockquote>
<p>小易的U盘中了一个奇怪的病毒，电脑中莫名其妙会多出来东西。小易重装了系统，把U盘送到了攻防实验室，希望借各位的知识分析出里面有啥。请大家加油噢，不过他特别关照，千万别乱点他U盘中的资料，那是机密。 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>我们使用 <code>foremost</code> 分离 iso文件，然后在 <code>autorun.inf</code> 文件中发现：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/CJrMUKPq73jgWVf.png" alt="image-20230129170342951" style="zoom:33%;" />

<p>flag与 <code>autoflag - 副本 (32).exe</code> 文件有关，我们可以使用 <code>ida</code> 打开exe文件获得flag，</p>
<p>或者使用 strings命令获得flag：<code>strings 32.exe | grep &quot;flag&quot;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/hq9HS2B3eXDEYpd.png" alt="image-20230129170507991"></p>
<h2 id="WUSTCTF2020-alison-likes-jojo"><a href="#WUSTCTF2020-alison-likes-jojo" class="headerlink" title="[WUSTCTF2020]alison_likes_jojo"></a>[WUSTCTF2020]alison_likes_jojo</h2><p>首先下载获得两个jpg图片，然后使用<code>foremost</code>分离其中一张图片，得到一个加密压缩包：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/7Cp4x8nK5Xa19hB.png" alt="image-20230129172919702" style="zoom:33%;" />



<p>使用 <code>ARCHPR</code> 爆破 ，得到密码：<code>888866</code></p>
<p>打开获得base64加密字符串，三次解码：<code>killerqueen</code></p>
<p>由于是 jpg 图片隐写，所以我们尝试几次 ：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7122075372283232293">那些图片隐写中的神操作之JPG</a></p>
<p>我们发现这里是 <strong>outguess 隐写</strong>，我们使用key解密：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">outguess -k &quot;killerqueen&quot; -r &quot;jljy.jpg&quot; flag.txt</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/sQY3obJCjHFVEUc.png" alt="image-20230129173200034" style="zoom:50%;" />

<p>获得flag</p>
<h2 id="安洵杯-2019-吹着贝斯扫二维码"><a href="#安洵杯-2019-吹着贝斯扫二维码" class="headerlink" title="[安洵杯 2019]吹着贝斯扫二维码"></a>[安洵杯 2019]吹着贝斯扫二维码</h2><p>下载后得到一个文件夹，里面有很多文件，我们使用 <code>010Editor</code>打开后发现都是jpg图片，我们使用脚本改后缀：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">r&#x27;C:\Users\LIKE\Desktop\dir&#x27;</span>  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(path):  <span class="comment"># 路径最好用绝对路径，不会出错</span></span><br><span class="line">    oldname = os.path.join(path, i)</span><br><span class="line">    newname = os.path.join(path, i + <span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">    os.rename(oldname, newname)</span><br></pre></td></tr></table></figure>

<p>我们发现都是二维码，我们需要拼图，</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/QpkAuGnf31JZ2vP.png" alt="image-20230129180236440"></p>
<p>每一个图片最后都有顺序，我们按照这个顺序使用ps进行拼图：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/bY8mU1pOVPHQ2SK.png" alt="image-20230129180318512" style="zoom:50%;" />

<p>如下：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/QhSa6b8pqzcxgI9.png" alt="202011032138450" style="zoom:33%;" />

<p>扫码得到：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/QMq5Stx2eiC1kY6.png" alt="image-20230129180440758" style="zoom:33%;" />

<p>（这个编码应该从右往左读）</p>
<p>我们打开zip文件：显然这是base32编码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/sIQmRbXYTWVi43e.png" alt="image-20230129180534458"></p>
<p>base32解码： <code>3A715D3E574E36326F733C5E625D213B2C62652E3D6E3B7640392F3137274038624148</code></p>
<p>然后转为 16进制字符串： <code>:q]&gt;WN62os&lt;^b]!;,be.=n;v@9/17&#39;@8bAH</code></p>
<p>然后这里提示一个 13编码，这里为 rot13，我们解密：</p>
<p><code>:d]&gt;JA62bf&lt;^o]!;,or.=a;i@9/17&#39;@8oNU</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/UfZhNQyuMKSpcwG.png" alt="image-20230129180709031"></p>
<p>然后base85解密：</p>
<p><code>PCtvdWU4VFJnQUByYy4mK1lraTA=</code></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/hgxV3GdXKsz1o4J.png" alt="image-20230129180739966" style="zoom:33%;" />

<p>base64解密： <code>&lt;+oue8TRgA@rc.&amp;+Yki0</code></p>
<p>最后base85解密：<code>ThisIsSecret!233</code></p>
<p>解压zip获得flag</p>
<h2 id="WUSTCTF2020-爬"><a href="#WUSTCTF2020-爬" class="headerlink" title="[WUSTCTF2020]爬"></a>[WUSTCTF2020]爬</h2><p>下载一个文件，使用 <code>010Editor</code> 打开，发现是一个pdf文件，改后缀为pdf，然后打开：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/8eRtNGjH6gZ9slh.png" alt="image-20230129195440509" style="zoom:33%;" />

<p>说flag被遮住了，我们使用 pdf编辑器删除上面的图片，里面还有一张图片：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/NQoxW36UOMc87lR.png" alt="image-20230129195613084"></p>
<p>发现是16进制，我们将其转化为字符串即可得到flag。</p>
<p><code>flag&#123;th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p&#125;</code></p>
<h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>我们首先下载，然后得到一个文件夹里面有很多 zip 文件，全被加密了：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/8wSVmq5MXygxERL.png" alt="image-20230129204116237" style="zoom:33%;" />

<p>但是我们发现每一个压缩包里的txt文件内容很小，都只有 <code>4字节</code>，于是我们可以使用crc32值进行</p>
<p><strong>crc32 4字节爆破</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/JGuoldMmHgP1wLk.png" alt="image-20230129204143111"></p>
<p>我们使用脚本爆破（也可以使用github上的脚本）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CrackCrc</span>(<span class="params">crc</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> h <span class="keyword">in</span> dic:</span><br><span class="line">                    s = i + j + k + h</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s.encode())):</span><br><span class="line">                        f.write(s)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CrackZip</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">68</span>):</span><br><span class="line">        file = <span class="string">r&quot;C://Users/LIKE/Desktop/dir/&quot;</span> + <span class="string">&#x27;out&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;.zip&#x27;</span></span><br><span class="line">        crc = zipfile.ZipFile(file, <span class="string">&#x27;r&#x27;</span>).getinfo(<span class="string">&#x27;data.txt&#x27;</span>).CRC <span class="comment"># 获得crc值</span></span><br><span class="line">        CrackCrc(crc)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\r&#x27;</span> + <span class="string">&quot;loading：&#123;:%&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">float</span>((i + <span class="number">1</span>) / <span class="number">68</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters + string.digits + <span class="string">&#x27;+/=&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nCRC32begin&quot;</span>)</span><br><span class="line">CrackZip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CRC32finished&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>获得一串base64编码，我们解密一下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/V7voIlNgR2OuyeY.png" alt="image-20230129204930639"></p>
<p>这16进制结尾应该是<code>rar文件</code> ，缺少文件头 <code>52 61 72 21 1A 07 00</code> ，我们补上，打开rar文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/rUFC6Is8AozVT9m.png" alt="image-20230129205107425"></p>
<h2 id="从娃娃抓起"><a href="#从娃娃抓起" class="headerlink" title="从娃娃抓起"></a>从娃娃抓起</h2><blockquote>
<p>题目描述：伟人的一句话，标志着一个时代的开始。那句熟悉的话，改变了许多人的一生，为中国三十年来计算机产业发展铺垫了道路。两种不同的汉字编码分别代表了汉字信息化道路上的两座伟大里程碑。请将你得到的话转为md5提交，md5统一为32位小写。</p>
</blockquote>
<p>打开txt文件，第2行应该是<code>五笔输入法</code>，第一行是 <code>中文电码</code>。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/Gzw13utN8UdTSDf.png" alt="image-20230129211039984" style="zoom:50%;" />

<p><a target="_blank" rel="noopener" href="http://code.mcdvisa.com/">中文电码解密</a></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/HvoJkdmypfluQcB.png" alt="image-20230129211305496" style="zoom:33%;" />

<p> <a target="_blank" rel="noopener" href="http://life.chacuo.net/convertwubi">在线五笔输入</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/qFlTKoPOBA7zfjd.png" alt="image-20230129211512925"></p>
<p><code>人工智能也要从娃娃抓起</code></p>
<p>md5加密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/6HhxYwsLqVcekuW.png" alt="image-20230129211647824"></p>
<h2 id="GUET-CTF2019-zips"><a href="#GUET-CTF2019-zips" class="headerlink" title="[GUET-CTF2019]zips"></a>[GUET-CTF2019]zips</h2><p>首先下载得到 zip压缩包 <code>222.zip</code> ，发现需要密码，但是我们不知道，我们只能使用 <code>ARCHPR</code> 爆破，获得密码，解压缩得到 <code>111.zip</code></p>
<p>发现是伪加密，我们可以使用工具 <code>ZipCenOp</code> 修复伪加密</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar ZipCenOp.jar r 111.zip</span><br></pre></td></tr></table></figure>

<p>打开，发现 <code>setup.sh</code> 文件：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">zip -e --password=`python -c <span class="string">&quot;print(__import__(&#x27;time&#x27;).time())&quot;</span>` flag.zip flag</span><br></pre></td></tr></table></figure>

<p>这里使用了 时间戳当作压缩包密码进行解压，但是我们不知道时间是多少。</p>
<p>我们先查看一下当前的时间戳（注意是python2）：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/Jzlp1TPLsixgrN3.png" alt="image-20230129213208408" style="zoom:50%;" />

<p>我们通过文件修改日期推测 时间戳是 15…..</p>
<p>我们可以使用<code>掩码爆破</code> ，进行解压：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/ZI4BUx9Kwt1dav3.png" alt="image-20230129213704650" style="zoom:50%;" />

<p>获得时间戳，我们进行解压，得到flag</p>
<h2 id="DDCTF2018-╯°□°）╯︵-┻━┻"><a href="#DDCTF2018-╯°□°）╯︵-┻━┻" class="headerlink" title="[DDCTF2018](╯°□°）╯︵ ┻━┻"></a>[DDCTF2018](╯°□°）╯︵ ┻━┻</h2><p>打开txt文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/Gl3fE1ICn9jFr4d.png" alt="image-20230129213835221"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</span><br></pre></td></tr></table></figure>
<p>长度134的字16进制符串，每两位进行截取</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;d4&#x27;, &#x27;e8&#x27;, &#x27;e1&#x27;, &#x27;f4&#x27;, &#x27;a0&#x27;, &#x27;f7&#x27;, &#x27;e1&#x27;, &#x27;f3&#x27;, &#x27;a0&#x27;, &#x27;e6&#x27;, &#x27;e1&#x27;, &#x27;f3&#x27;, &#x27;f4&#x27;, &#x27;a1&#x27;, &#x27;a0&#x27;, &#x27;d4&#x27;, &#x27;e8&#x27;, &#x27;e5&#x27;, &#x27;a0&#x27;, &#x27;e6&#x27;, &#x27;ec&#x27;, &#x27;e1&#x27;, &#x27;e7&#x27;, &#x27;a0&#x27;, &#x27;e9&#x27;, &#x27;f3&#x27;, &#x27;ba&#x27;, &#x27;a0&#x27;, &#x27;c4&#x27;, &#x27;c4&#x27;, &#x27;c3&#x27;, &#x27;d4&#x27;, &#x27;c6&#x27;, &#x27;fb&#x27;, &#x27;b9&#x27;, &#x27;b2&#x27;, &#x27;b2&#x27;, &#x27;e1&#x27;, &#x27;e2&#x27;, &#x27;b9&#x27;, &#x27;b9&#x27;, &#x27;b7&#x27;, &#x27;b4&#x27;, &#x27;e1&#x27;, &#x27;b4&#x27;, &#x27;b7&#x27;, &#x27;e3&#x27;, &#x27;e4&#x27;, &#x27;b3&#x27;, &#x27;b2&#x27;, &#x27;b2&#x27;, &#x27;e3&#x27;, &#x27;e6&#x27;, &#x27;b4&#x27;, &#x27;b3&#x27;, &#x27;e2&#x27;, &#x27;b5&#x27;, &#x27;b0&#x27;, &#x27;b6&#x27;, &#x27;b1&#x27;, &#x27;b0&#x27;, &#x27;e6&#x27;, &#x27;e1&#x27;, &#x27;e5&#x27;, &#x27;e1&#x27;, &#x27;b5&#x27;, &#x27;fd&#x27;]</span><br></pre></td></tr></table></figure>

<p>转为10进制：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[212, 232, 225, 244, 160, 247, 225, 243, 160, 230, 225, 243, 244, 161, 160, 212, 232, 229, 160, 230, 236, 225, 231, 160, 233, 243, 186, 160, 196, 196, 195, 212, 198, 251, 185, 178, 178, 225, 226, 185, 185, 183, 180, 225, 180, 183, 227, 228, 179, 178, 178, 227, 230, 180, 179, 226, 181, 176, 182, 177, 176, 230, 225, 229, 225, 181, 253]</span><br></pre></td></tr></table></figure>

<p>将大于 128的数字减128得到ascii码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[84, 104, 97, 116, 32, 119, 97, 115, 32, 102, 97, 115, 116, 33, 32, 84, 104, 101, 32, 102, 108, 97, 103, 32, 105, 115, 58, 32, 68, 68, 67, 84, 70, 123, 57, 50, 50, 97, 98, 57, 57, 55, 52, 97, 52, 55, 99, 100, 51, 50, 50, 99, 102, 52, 51, 98, 53, 48, 54, 49, 48, 102, 97, 101, 97, 53, 125]</span><br></pre></td></tr></table></figure>

<p>全部转为字符：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">That was fast! The flag is: DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><br></pre></td></tr></table></figure>

<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_str</span>(<span class="params"><span class="built_in">str</span></span>):<span class="comment">#对字符串进行切片操作，每两位截取</span></span><br><span class="line">    hex_str_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>)-<span class="number">1</span>,<span class="number">2</span>):</span><br><span class="line">        hex_str=<span class="built_in">str</span>[i:i+<span class="number">2</span>]</span><br><span class="line">        hex_str_list.append(hex_str)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;hex列表：%s\n&quot;</span>%hex_str_list)</span><br><span class="line">    hex_to_str(hex_str_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_str</span>(<span class="params">hex_str_list</span>):</span><br><span class="line">    int_list=[]</span><br><span class="line">    dec_list=[]</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(hex_str_list)):<span class="comment">#把16进制转化为10进制</span></span><br><span class="line">        int_str=<span class="built_in">int</span>(<span class="string">&#x27;0x%s&#x27;</span>%hex_str_list[i],<span class="number">16</span>)</span><br><span class="line">        int_list.append(int_str)</span><br><span class="line">        dec_list.append(int_str-<span class="number">128</span>)<span class="comment">#-128得到正确的ascii码</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dec_list)):<span class="comment">#ascii码转化为字符串</span></span><br><span class="line">        flag += <span class="built_in">chr</span>(dec_list[i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;转化为十进制int列表：%s\n&quot;</span>%int_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-128得到ASCII十进制dec列表：%s\n&quot;</span>%dec_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;最终答案：%s&#x27;</span>%flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">str</span>=<span class="string">&#x27;d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;字符串长度：%s&quot;</span>%<span class="built_in">len</span>(<span class="built_in">str</span>))</span><br><span class="line">    hex_str(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>



<h2 id="WUSTCTF2020-girlfriend"><a href="#WUSTCTF2020-girlfriend" class="headerlink" title="[WUSTCTF2020]girlfriend"></a>[WUSTCTF2020]girlfriend</h2><p>下载获得一个 wav音频文件，播放一下，听起来像打电话，于是我们可以使用工具 <code>dtmf2num</code>，进行拨号音识别：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/3GAEKh6SJjPiC4Y.png" alt="image-20230129215340438"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">999*666*88*2*777*33*6*999*4*444*777*555*333*777*444*33*66*3*7777</span><br></pre></td></tr></table></figure>

<p>看这一串数字，应该是手机键盘加密。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/jaSVPu361YUyIfe.png" alt="在这里插入图片描述"></p>
<p><code>999</code>就是指按三下数字9得到的字母也就是<code>y</code>，以此类推，数字对应手机的每个键位，几个数字代表按几下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">999     ---&gt;   y</span><br><span class="line">666     ---&gt;   o</span><br><span class="line">88      ---&gt;   u</span><br><span class="line">2       ---&gt;   a</span><br><span class="line">777     ---&gt;   r</span><br><span class="line">33      ---&gt;   e</span><br><span class="line">6       ---&gt;   m</span><br><span class="line">999     ---&gt;   y</span><br><span class="line">4       ---&gt;   g</span><br><span class="line">4444    ---&gt;   i</span><br><span class="line">777     ---&gt;   r</span><br><span class="line">555     ---&gt;   l</span><br><span class="line">333     ---&gt;   f</span><br><span class="line">777     ---&gt;   r</span><br><span class="line">444     ---&gt;   i</span><br><span class="line">33      ---&gt;   e</span><br><span class="line">66      ---&gt;   n</span><br><span class="line">3       ---&gt;   d</span><br><span class="line">7777    ---&gt;   s</span><br><span class="line"></span><br><span class="line">youaremygirlfriends</span><br></pre></td></tr></table></figure>





<h2 id="MRCTF2020-千层套路"><a href="#MRCTF2020-千层套路" class="headerlink" title="[MRCTF2020]千层套路"></a>[MRCTF2020]千层套路</h2><p>这一题是一个 zip无线套娃题</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/1Nryh7p9oKxOsba.png" alt="image-20230129215712623" style="zoom:33%;" />

<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line">filepath = <span class="string">&quot;0573.zip&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> zipfile.is_zipfile(<span class="string">&quot;zip/&quot;</span> + filepath): <span class="comment"># 当文件是zip文件时</span></span><br><span class="line">    pwd = filepath.split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>] <span class="comment">#获得解压密码</span></span><br><span class="line">    file = zipfile.ZipFile(<span class="string">&quot;zip/&quot;</span> + filepath) <span class="comment"># 创建一个ZipFile对象，表示一个zip文件</span></span><br><span class="line">    filepath = file.namelist().pop() <span class="comment"># namelist()获取zip文档内所有文件的名称列表</span></span><br><span class="line">    file.extract(filepath, <span class="string">r&quot;D:\Applications\CTF\phpstudy_pro\WWW\scripts_py\BUUCTF\zip&quot;</span>, pwd=pwd.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    file.close()</span><br><span class="line">    <span class="built_in">print</span>(filepath)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解压成功！&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="XMAN2018排位赛-通行证"><a href="#XMAN2018排位赛-通行证" class="headerlink" title="[XMAN2018排位赛]通行证"></a>[XMAN2018排位赛]通行证</h2><p>首先base64解密：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/nHSXJRM7QWZvq5V.png" alt="image-20230129220121336" style="zoom:33%;" />

<p>得到： <code>kanbbrgghjl&#123;zb____&#125;vtlaln</code> ，这个可能是<code>栅栏密码</code>。</p>
<p><code>注意：此处是栅栏加密，不是解密</code> <a target="_blank" rel="noopener" href="http://www.hiencode.com/railfence.html">栅栏密码</a></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/29/BhlKkHmq6W5Yic4.png" alt="image-20230129220435582" style="zoom:33%;" />

<p>每组字数为7。</p>
<p>然后发现应该<code>凯撒解密</code>，得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xman&#123;oyay_now_you_get_it&#125;</span><br></pre></td></tr></table></figure>



<h2 id="百里挑一"><a href="#百里挑一" class="headerlink" title="百里挑一"></a>百里挑一</h2><p>下载得到一个 pcapng文件，我们使用 wireshark导出 http对象，发现一堆图片。</p>
<p>然后我们使用 <code>exiftool</code> 工具 ，查看所有图片的 详细信息，并且过滤出带有 { 的字段</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/vgzrs6y2bo9FUDB.png" alt="image-20230129221834003"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exiftool * | grep &#x27;&#123;&#x27;</span><br></pre></td></tr></table></figure>

<p>我们得到了一半的 flag</p>
<p>我们我们在 wireshark 中过滤，查找字符串 <code>Exif</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tcp contains &quot;Exif&quot;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/8BQXLSUN6oKdh2A.png" alt="image-20230129222327838"></p>
<p>找到另一半flag：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/ywU2EqugIQZ7aRr.png" alt="image-20230129222415741"></p>
<h2 id="SUCTF2018-followme"><a href="#SUCTF2018-followme" class="headerlink" title="[SUCTF2018]followme"></a>[SUCTF2018]followme</h2><p>我们使用 wireshark 导出 http对象：</p>
<p>一大串登录的东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/QCXj3ytWwiOz2ke.png" alt="image-20230129232915858"></p>
<p>我们使用 linux <code>grep</code> 命令</p>
<p><code>grep -r &quot;CTF&quot;</code> 查找整个目录下的字符串，得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/lidRkDQeEj687Jw.png" alt="image-20230129232701324"></p>
<h2 id="UTCTF2020-file-header"><a href="#UTCTF2020-file-header" class="headerlink" title="[UTCTF2020]file header"></a>[UTCTF2020]file header</h2><p>使用 010Editor 改一下文件头即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/29/CWhzHfplN1D5TRZ.png" alt="image-20230129233235714"></p>
<h2 id="MRCTF2020-CyberPunk"><a href="#MRCTF2020-CyberPunk" class="headerlink" title="[MRCTF2020]CyberPunk"></a>[MRCTF2020]CyberPunk</h2><p>下载后获得一个exe程序，打开：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/FLZo3l1ujKTkYcf.png" alt="image-20230130104633584" style="zoom:33%;" />

<p>提示说，只要我们时间是 <code>2020.9.17</code> 就能得到flag。</p>
<p>我们只需要修改计算机系统时间为 <code>2020.9.17</code> 即可</p>
<h2 id="安洵杯-2019-Attack"><a href="#安洵杯-2019-Attack" class="headerlink" title="[安洵杯 2019]Attack"></a>[安洵杯 2019]Attack</h2><p>首先使用 <code>foremost</code> 分离 pcap 文件，得到一个压缩包：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/FYb7HC1GMt23XTf.png" alt="image-20230130114755836"></p>
<p>然后查看wp后，发现这个需要获取到管理员的密码去解压。</p>
<p>我们这里需要用到一个工具： <code>mimikatz</code></p>
<blockquote>
<p><code>mimikatz</code> 在内网渗透中是个很有用的工具。<code>mimikatz</code>可以在内存中爬取到<strong>明文密码</strong></p>
</blockquote>
<p>下载：<br> <a target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz/releases/">https://github.com/gentilkiwi/mimikatz/releases/</a></p>
<p>然后我们可以使用 wireshark 去导出 <code>lsass.dmp</code> 内存镜像</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/swnj6HXWrCRkh5y.png" alt="image-20230130115322693"></p>
<blockquote>
<p><strong>关于lsass</strong></p>
<p> <strong>lsass</strong>是windows系统的一个进程，用于本地安全和登陆策略。</p>
<p><code>mimikatz</code>可以从 lsass.exe 里获取windows处于<strong>active状态账号明文密码</strong>。</p>
</blockquote>
<p>本题的<code>lsass.dmp</code>就是内存运行的镜像，也可以提取到账户密码</p>
<p>如何使用？我们可以先将 <code>lsass.dmp</code> 复制到<code>mimikatz</code>目录下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/mPu1yQUsJX4Iqir.png" alt="image-20230130115531772"></p>
<p>然后右键<strong>管理员运行</strong> <code>mimikatz.exe</code>：（不用会报错）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/9QbhtGMnc1iljZw.png" alt="image-20230130115615175"></p>
<p>输入：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//提升权限</span><br><span class="line">privilege::debug</span><br><span class="line">//载入dmp文件</span><br><span class="line">sekurlsa::minidump lsass.dmp</span><br><span class="line">//读取登陆密码</span><br><span class="line">sekurlsa::logonpasswords full</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/klf5H12GsyAPza9.png" alt="image-20230130115822351"></p>
<p>密码： <code>W3lc0meToD0g3</code></p>
<p>解压zip得到flag</p>
<h2 id="SUCTF-2019-Game"><a href="#SUCTF-2019-Game" class="headerlink" title="[SUCTF 2019]Game"></a>[SUCTF 2019]Game</h2><p>下载后得到一个游戏源码和一张图片。</p>
<p>在游戏源码 <code>index.html</code> 中，我们发现了一个fake flag：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/B3yQKfiEDznSmo9.png" alt="image-20230130124848144"></p>
<p>这是base32编码，我们解码： <code>suctf&#123;hAHaha_Fak3_F1ag&#125; </code> 一个假的flag</p>
<p>然后我们去分析图片：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/GSaAxcBLdJuHDt2.png" alt="image-20230130125013103" style="zoom:33%;" />

<p>我们发现了 LSB隐写：</p>
 <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/SNV5zr2qUKEMkbH.png" alt="image-20230130125055316" style="zoom:33%;" />



<p>这一串看着像 base64，但是我们解码一下： <code>Salted__³4yíYRÁ|ÜTVK»¤&amp;Ñ:?)ëËÊkU</code></p>
<p><code>Salted</code>开头，一个是 AES、DES等编码，经过测试，发现是 <code>3DES</code> 即：<code>TripleDES</code></p>
<p>密钥就是：<code>suctf&#123;hAHaha_Fak3_F1ag&#125;</code>，</p>
<p>解密得到flag：<a target="_blank" rel="noopener" href="https://www.sojson.com/encrypt_triple_des.html">https://www.sojson.com/encrypt_triple_des.html</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/zpBJjgPOyGQbLit.png" alt="image-20230130125545910"></p>
<h2 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h2><blockquote>
<p>Do your konw usb?? 注意：得到的 flag 请包上 flag{} 提交</p>
</blockquote>
<p>下载后得到一个 <code>rar压缩包</code> 和 <code>key.ftm</code> 文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/dR5XjmE8wD9sepQ.png" alt="image-20230130134615328"></p>
<p>使用 <code>010Editor</code> 打开 <code>key.ftm</code> ：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/vUZHM8kNfecmSQx.png" alt="image-20230130134738445" style="zoom: 50%;" />

<p>我们发现其中隐藏着 zip压缩包，我们使用 <code>foremost</code> 分离得到 流量包文件：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/S8XtvyFAhOjKUNp.png" alt="image-20230130134834406"></p>
<p>观察可知，这是<code>USB流量包分析</code> ，这一题是 <code>USB键盘流量分析</code>.</p>
<blockquote>
<p><strong>USB流量</strong>指的是USB设备接口的流量，攻击者能够通过监听usb接口流量获取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。在CTF中，USB流量分析主要以键盘和鼠标流量为主。</p>
</blockquote>
<blockquote>
<p><strong>键盘流量</strong></p>
<p>USB协议数据部分在Leftover Capture Data域中，数据长度为<code>八个字节</code>。其中键盘击键信息集中在第三个字节中。</p>
</blockquote>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/7R8zFoOWGvp5VaI.png" alt="image-20230130135235146" style="zoom:50%;" />

<p>如图，发现击键信息为0x06，即对应的按键为<code>C</code><br>键位映射关系参考：<a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html">《USB键盘协议中键码》中的HID Usage ID</a></p>
<p>我们可以使用 linux 的 <code>tshark</code>命令 把usb流量包key.pcap中 <code>capdata</code> 读取出来：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">tshark -r key.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class="line">tshark -r key.pcap -T fields -e usb.capdata | sed <span class="string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt <span class="comment">#提取并去除空行</span></span><br></pre></td></tr></table></figure>

<p>我们查看一下txt文件：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/EBrxc6APsOGKvzl.png" alt="image-20230130135745207" style="zoom:33%;" />

<p>提取出来的数据可能会带<strong>冒号</strong>，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别</p>
<blockquote>
<p>有冒号时提取数据的<code>[6:8]</code><br>无冒号时数据在<code>[4:6]</code></p>
</blockquote>
<p>可以用脚本来加上冒号：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time : 2023/1/30 13:59</span></span><br><span class="line"><span class="comment"># @Author : Leekos</span></span><br><span class="line"><span class="comment"># @File : USB_tshark_键盘capdata添加冒号.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;C://Users/LIKE/Desktop/data.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;C://Users/LIKE/Desktop/out.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">16</span>:  <span class="comment"># 鼠标流量的话len改为8</span></span><br><span class="line">            out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a), <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i + <span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>] + <span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>

<p>如图：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/E3ebm4GlRLHT5qP.png" alt="image-20230130140736769" style="zoom:33%;" />

<p>此时对应的第三字节，也就是**[6:8]**就代表了击键信息</p>
<p>提取出键盘流量后需要用<strong>脚本还原数据对应的信息</strong>。同时找到两个还原信息的脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line">mappings = &#123; <span class="number">0x04</span>:<span class="string">&quot;A&quot;</span>,  <span class="number">0x05</span>:<span class="string">&quot;B&quot;</span>,  <span class="number">0x06</span>:<span class="string">&quot;C&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;D&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;E&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;F&quot;</span>, <span class="number">0x0A</span>:<span class="string">&quot;G&quot;</span>,  <span class="number">0x0B</span>:<span class="string">&quot;H&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;I&quot;</span>,  <span class="number">0x0D</span>:<span class="string">&quot;J&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;K&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;L&quot;</span>, <span class="number">0x10</span>:<span class="string">&quot;M&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;N&quot;</span>,<span class="number">0x12</span>:<span class="string">&quot;O&quot;</span>,  <span class="number">0x13</span>:<span class="string">&quot;P&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;Q&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;R&quot;</span>, <span class="number">0x16</span>:<span class="string">&quot;S&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;T&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;U&quot;</span>,<span class="number">0x19</span>:<span class="string">&quot;V&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;W&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;X&quot;</span>, <span class="number">0x1C</span>:<span class="string">&quot;Y&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;Z&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4&quot;</span>, <span class="number">0x22</span>:<span class="string">&quot;5&quot;</span>,  <span class="number">0x23</span>:<span class="string">&quot;6&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0&quot;</span>, <span class="number">0x28</span>:<span class="string">&quot;\n&quot;</span>, <span class="number">0x2a</span>:<span class="string">&quot;[DEL]&quot;</span>,  <span class="number">0X2B</span>:<span class="string">&quot;    &quot;</span>, <span class="number">0x2C</span>:<span class="string">&quot; &quot;</span>,  <span class="number">0x2D</span>:<span class="string">&quot;-&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&quot;</span>,  <span class="number">0x30</span>:<span class="string">&quot;]&quot;</span>,  <span class="number">0x31</span>:<span class="string">&quot;\\&quot;</span>, <span class="number">0x32</span>:<span class="string">&quot;~&quot;</span>, <span class="number">0x33</span>:<span class="string">&quot;;&quot;</span>,  <span class="number">0x34</span>:<span class="string">&quot;&#x27;&quot;</span>, <span class="number">0x36</span>:<span class="string">&quot;,&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;C://Users/LIKE/Desktop/out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line">    nums.append(<span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</span><br><span class="line">        output += mappings[n]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;output :\n&#x27;</span> + output</span><br></pre></td></tr></table></figure>

<p>脚本2（两个都可以）：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"></span><br><span class="line">normalKeys = &#123;</span><br><span class="line">    <span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line">    <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line">     <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line">      <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line">       <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line">        <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line">         <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,</span><br><span class="line">         <span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,</span><br><span class="line">         <span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,</span><br><span class="line">         <span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,</span><br><span class="line">         <span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,</span><br><span class="line">         <span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,</span><br><span class="line">         <span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;</span><br><span class="line">    <span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line">     <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line">      <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line">       <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line">        <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line">         <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,</span><br><span class="line">          <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,</span><br><span class="line">          <span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,</span><br><span class="line">          <span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line">          <span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,</span><br><span class="line">          <span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,</span><br><span class="line">          <span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;C://Users/LIKE/Desktop/out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">             <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">            flag+=<span class="number">1</span></span><br><span class="line">            output.pop(i)</span><br><span class="line">            <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                flag=<span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">            output[i]=output[i].upper()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure>

<p>运行脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">输出：</span><br><span class="line">output :key&#123;xinan&#125;</span><br></pre></td></tr></table></figure>

<p>于是我们得到密钥：<code>xinan</code></p>
<p><a target="_blank" rel="noopener" href="https://qwzf.github.io/2020/08/01/CTF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B(%E4%BA%8C)-USB%E6%B5%81%E9%87%8F/">参考：USB流量分析</a></p>
<p>我们也可以使用工具: <code>UsbKeyboardDataHacker</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/eCHlJzgISx2pPZG.png" alt="image-20230130141107287"></p>
<p>接着我们再分析那一个rar压缩包：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/Re5TmkMrgq9PAIv.png" alt="image-20230130141213163"></p>
<p>发现文件头损坏，于是查资料进行对照，</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/Gb2NnwPHVudrU4I.png" alt="image-20230130141414932"></p>
<p>将这里改为 <code>74</code> 即可：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/awKjpyJdzfgXexR.png" alt="image-20230130141452506"></p>
<p>我们得到一张 png 图片，使用 <code>stegsolve</code> 在<code>blue 0 通道</code> 发现二维码：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/9iLV3dbj6Q4gswA.png" alt="image-20230130141605723" style="zoom: 25%;" />

<p>扫码获得：<code>ci&#123;v3erf_0tygidv2_fc0&#125;</code></p>
<p>可能是栅栏密码，我们解密一下，得到：<code>cyig&#123;ivd3ve2r_ff_c00t&#125;</code></p>
<p>这个很想<code>凯撒密码</code>，但是不是，</p>
<p>查阅资料得知了一个密码：**<code>维吉尼亚密码</code>**</p>
<blockquote>
<p><strong>凯撒密码</strong>中，字母表中的每一字母都会作一定的偏移。<br> 当偏移量为3时，A就转换为了D、B转换为了E……因为凯撒密码中所有字母的偏移量是一样的</p>
<p>【<strong>维吉尼亚密码</strong>】则是由一些偏移量不同的恺撒密码组成</p>
<p>为了生成密码，需要使用<strong>表格法</strong>。</p>
<p>这一表格包括了26行字母表，每一行都由前一行向左偏移一位得到。具体使用哪一行字母表进行编译是基于密钥进行的，在过程中会不断地变换。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="./s2.loli.net/2023/01/30/3FOonBsW4yzqluM.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>例如，假设<strong>明文</strong>为：HEETIAN</p>
<p>  然后选择<strong>某一关键词并重复</strong>而得到<strong>密钥</strong>，如关键词为LAB时，密钥为：LABLABL</p>
<p>  对于明文的第一个字母H，对应密钥的第一个字母L，于是使用表格中L行字母表进行加密，得到密文第一个字母S。<br>  类似地，明文第二个字母为E，在表格中使用对应的A行进行加密，得到密文第二个字母E。以此类推，可以得到：</p>
<p>  明文：HEETIAN</p>
<p>  密钥：LABLABL</p>
<p>  密文：SEFEIBY</p>
<p>  <strong>解密的过程则与加密相反。</strong><br>  例如：根据密钥第一个字母L所对应的L行字母表，发现密文第一个字母S位于H列，因而明文第一个字母为H。<br>  密钥第二个字母A对应A行字母表，而密文第二个字母E位于此行E列，因而明文第二个字母为E。以此类推便可得到明文。</p>
</blockquote>
<p>简单地说:【<strong>维吉尼亚密码</strong>】是由一些<strong>偏移量不同</strong>的恺撒密码组成，解密需要密钥。</p>
<p>因此我们可以进行解密，但是尝试之后，我们发现需要：先维吉尼亚密码解密，再栅栏解密。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/hzVg76wmdoFRKvL.png" alt="image-20230130142443064" style="zoom:33%;" />

<p>然后栅栏解密：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://s2.loli.net/2023/01/30/3QU1oKmEbgXWOhf.png" alt="image-20230130142527956" style="zoom:33%;" />





</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://leekoscn.github.io">LIKE</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://leekoscn.github.io/posts/c7949ef5880d/">https://leekoscn.github.io/posts/c7949ef5880d/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://leekoscn.github.io" target="_blank">Tranquility</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E3%80%90BUUCTF%E3%80%91MISC-%E7%AC%AC3%E9%A1%B5wp/">【BUUCTF】MISC(第3页wp)</a></div><div class="post_share"><div class="social-share" data-image="/img/hello-world.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechatpay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/wechatpay.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/0c629084ff88/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="onerror=null;src='/img/hello-world.webp'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【BUUCTF】MISC(第4页wp)</div></div></a></div><div class="next-post pull-right"><a href="/posts/db085aaa1192/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="onerror=null;src='/img/hello-world.webp'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【BUUCTF】MISC(第2页wp)</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">LIKE</div><div class="author-info__description">这是个人博客，分享技术的地方~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">215</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/leekoscn"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/leekoscn" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_61839115?spm=1000.2115.3001.5343" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=2500495325&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:2500495325@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2018-single-dog"><span class="toc-number">1.</span> <span class="toc-text">[SUCTF2018]single dog</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%90%83%E4%B8%89%E6%98%8E%E6%B2%BB"><span class="toc-number">2.</span> <span class="toc-text">我吃三明治</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqltest"><span class="toc-number">3.</span> <span class="toc-text">sqltest</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">3.1.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SWPU2019-%E4%BD%A0%E6%9C%89%E6%B2%A1%E6%9C%89%E5%A5%BD%E5%A5%BD%E7%9C%8B%E7%BD%91%E8%AF%BE"><span class="toc-number">4.</span> <span class="toc-text">[SWPU2019]你有没有好好看网课?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-NTFS%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">5.</span> <span class="toc-text">[ACTF新生赛2020]NTFS数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#john-in-the-middle"><span class="toc-number">6.</span> <span class="toc-text">john-in-the-middle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-swp"><span class="toc-number">7.</span> <span class="toc-text">[ACTF新生赛2020]swp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5"><span class="toc-number">8.</span> <span class="toc-text">喵喵喵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw"><span class="toc-number">9.</span> <span class="toc-text">[GXYCTF2019]SXMgdGhpcyBiYXNlPw&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%B4%E8%B0%8D%E5%90%AF%E7%A4%BA%E5%BD%95"><span class="toc-number">10.</span> <span class="toc-text">间谍启示录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTCTF2020-docx"><span class="toc-number">11.</span> <span class="toc-text">[UTCTF2020]docx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysterious"><span class="toc-number">12.</span> <span class="toc-text">Mysterious</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-number">13.</span> <span class="toc-text">弱口令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF2019-%E9%BB%84%E9%87%916%E5%B9%B4"><span class="toc-number">14.</span> <span class="toc-text">[RoarCTF2019]黄金6年</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E6%98%93%E7%9A%84U%E7%9B%98"><span class="toc-number">15.</span> <span class="toc-text">小易的U盘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-alison-likes-jojo"><span class="toc-number">16.</span> <span class="toc-text">[WUSTCTF2020]alison_likes_jojo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E5%90%B9%E7%9D%80%E8%B4%9D%E6%96%AF%E6%89%AB%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">17.</span> <span class="toc-text">[安洵杯 2019]吹着贝斯扫二维码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-%E7%88%AC"><span class="toc-number">18.</span> <span class="toc-text">[WUSTCTF2020]爬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zip"><span class="toc-number">19.</span> <span class="toc-text">zip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E5%A8%83%E5%A8%83%E6%8A%93%E8%B5%B7"><span class="toc-number">20.</span> <span class="toc-text">从娃娃抓起</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUET-CTF2019-zips"><span class="toc-number">21.</span> <span class="toc-text">[GUET-CTF2019]zips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDCTF2018-%E2%95%AF%C2%B0%E2%96%A1%C2%B0%EF%BC%89%E2%95%AF%EF%B8%B5-%E2%94%BB%E2%94%81%E2%94%BB"><span class="toc-number">22.</span> <span class="toc-text">[DDCTF2018](╯°□°）╯︵ ┻━┻</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-girlfriend"><span class="toc-number">23.</span> <span class="toc-text">[WUSTCTF2020]girlfriend</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF"><span class="toc-number">24.</span> <span class="toc-text">[MRCTF2020]千层套路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XMAN2018%E6%8E%92%E4%BD%8D%E8%B5%9B-%E9%80%9A%E8%A1%8C%E8%AF%81"><span class="toc-number">25.</span> <span class="toc-text">[XMAN2018排位赛]通行证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BE%E9%87%8C%E6%8C%91%E4%B8%80"><span class="toc-number">26.</span> <span class="toc-text">百里挑一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2018-followme"><span class="toc-number">27.</span> <span class="toc-text">[SUCTF2018]followme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTCTF2020-file-header"><span class="toc-number">28.</span> <span class="toc-text">[UTCTF2020]file header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-CyberPunk"><span class="toc-number">29.</span> <span class="toc-text">[MRCTF2020]CyberPunk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-Attack"><span class="toc-number">30.</span> <span class="toc-text">[安洵杯 2019]Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF-2019-Game"><span class="toc-number">31.</span> <span class="toc-text">[SUCTF 2019]Game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#USB"><span class="toc-number">32.</span> <span class="toc-text">USB</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/50182c4e289e/" title="小迪-day17(编解码、二次注入、DNSlog盲注)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="this.onerror=null;this.src='/img/hello-world.webp'" alt="小迪-day17(编解码、二次注入、DNSlog盲注)"/></a><div class="content"><a class="title" href="/posts/50182c4e289e/" title="小迪-day17(编解码、二次注入、DNSlog盲注)">小迪-day17(编解码、二次注入、DNSlog盲注)</a><time datetime="2023-08-22T10:05:22.621Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ee597ef53526/" title="小迪-day16（报错注入，延时、布尔盲注）"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="this.onerror=null;this.src='/img/hello-world.webp'" alt="小迪-day16（报错注入，延时、布尔盲注）"/></a><div class="content"><a class="title" href="/posts/ee597ef53526/" title="小迪-day16（报错注入，延时、布尔盲注）">小迪-day16（报错注入，延时、布尔盲注）</a><time datetime="2023-08-22T10:05:22.618Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/fa45560e3521/" title="小迪-day15(Oracle，MongoDB、access、msSQL、postgresql注入)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="this.onerror=null;this.src='/img/hello-world.webp'" alt="小迪-day15(Oracle，MongoDB、access、msSQL、postgresql注入)"/></a><div class="content"><a class="title" href="/posts/fa45560e3521/" title="小迪-day15(Oracle，MongoDB、access、msSQL、postgresql注入)">小迪-day15(Oracle，MongoDB、access、msSQL、postgresql注入)</a><time datetime="2023-08-22T10:05:22.617Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/44edbd1b2eba/" title="小迪-day14(注入类型之提交注入)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="this.onerror=null;this.src='/img/hello-world.webp'" alt="小迪-day14(注入类型之提交注入)"/></a><div class="content"><a class="title" href="/posts/44edbd1b2eba/" title="小迪-day14(注入类型之提交注入)">小迪-day14(注入类型之提交注入)</a><time datetime="2023-08-22T10:05:22.615Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b6e16bf4bb82/" title="小迪-day13(MySQL注入)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/hello-world.webp" onerror="this.onerror=null;this.src='/img/hello-world.webp'" alt="小迪-day13(MySQL注入)"/></a><div class="content"><a class="title" href="/posts/b6e16bf4bb82/" title="小迪-day13(MySQL注入)">小迪-day13(MySQL注入)</a><time datetime="2023-08-22T10:05:22.611Z" title="发表于 2023-08-22 18:05:22">2023-08-22</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/hello-world.webp')"><div id="footer-wrap"><div class="copyright">&copy;2022-09 - 2023 By LIKE</div><div class="framework-info"><a href="https://beian.miit.gov.cn"  style="color:#fff" target="_blank">赣ICP备2022008842号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'e5J90iDkXMWhU5UNlEX1I2hO-gzGzoHsz',
      appKey: 'esLROw9j3xLk2nV4tQkKaih1',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('col l3 hide-on-med-and-down expanded')[0];
                var item_html = '<div class="card-widget card-clock"> <div class="card-glass"> <div class="card-background"><div class="card-content"> <div id="hexo_electric_clock"> <img id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('col l3 hide-on-med-and-down expanded')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('col l3 hide-on-med-and-down expanded')[0];
    var item_html = '<div class="card-widget card-clock"> <div class="card-glass"> <div class="card-background"><div class="card-content"> <div id="hexo_electric_clock"> <img id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://unpkg.zhimg.com/hexo-butterfly-clock/lib/clock.min.js"></script><!-- hexo injector body_end end -->
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(e){e.imageLazyLoadSetting.processImages=t;var n=e.imageLazyLoadSetting.isSPA,i=e.imageLazyLoadSetting.preloadRatio||1,r=o();function o(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){n&&(r=o());for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(e.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];e=function(){r=r.filter(function(t){return o!==t})},(t=o).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,t.removeAttribute("data-original"),e&&e()},t.src!==i&&(n.src=i))}()}function a(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",a),e.addEventListener("resize",a),e.addEventListener("orientationchange",a)}(this);</script></body></html>